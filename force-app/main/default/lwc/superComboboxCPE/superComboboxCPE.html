<template>
    <div class="slds-form">
        <!-- Object Selection -->
        <div class="slds-form-element slds-m-bottom_small">
            <template if:true={isLoadingObjects}>
                <lightning-spinner alternative-text="Loading objects" size="small"></lightning-spinner>
            </template>
            <lightning-combobox
                name="object"
                label="Select Object"
                value={selectedObject}
                placeholder="Choose an object"
                options={objectOptions}
                onchange={handleObjectChange}
                disabled={isLoadingObjects}
                required
            ></lightning-combobox>
        </div>

        <!-- Field Selection -->
        <template if:true={selectedObject}>
            <div class="slds-form-element slds-m-bottom_small">
                <template if:true={isLoadingFields}>
                    <lightning-spinner alternative-text="Loading fields" size="small"></lightning-spinner>
                </template>
                <lightning-combobox
                    name="field"
                    label="Select Picklist Field"
                    value={selectedField}
                    placeholder="Choose a picklist field"
                    options={fieldOptions}
                    onchange={handleFieldChange}
                    disabled={isLoadingFields}
                    required
                ></lightning-combobox>
            </div>

            <!-- Initial Selected Value -->
            <div class="slds-form-element slds-m-bottom_small">
                <c-fsc_flow-combobox
                    name="initialSelectedValue"
                    label="Initial Selected Value"
                    value={initialSelectedValue}
                    builder-context={builderContext}
                    automatic-output-variables={automaticOutputVariables}
                    onvaluechanged={handleInitialSelectedValueChange}
                ></c-fsc_flow-combobox>
            </div>
            
            <!-- Picklist Value Definitions -->
            <template if:true={showPicklistDefinitions}>
                <div class="slds-m-top_small">
                    <h3 class="slds-text-heading_small slds-m-bottom_x-small">Picklist Value Definitions</h3>
                    <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">
                        Define custom help text for each picklist value
                    </p>
                    
                    <div class="slds-box slds-box_x-small slds-theme_shade">
                        <template for:each={picklistValues} for:item="picklistValue">
                            <div key={picklistValue.value} class="slds-form-element slds-m-bottom_x-small">
                                <label class="slds-form-element__label slds-text-body_small">
                                    <strong>{picklistValue.label}</strong> ({picklistValue.value})
                                </label>
                                <div class="slds-form-element__control">
                                    <lightning-input
                                        type="text"
                                        placeholder="Enter help text"
                                        value={picklistValue.definition}
                                        data-value={picklistValue.value}
                                        onchange={handleDefinitionChange}
                                        variant="label-hidden"
                                    ></lightning-input>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </template>

        <!-- Standard Configuration -->
        <div class="slds-form-element slds-m-bottom_small">
            <lightning-input
                label="Card Title"
                value={cardTitle}
                onchange={handleCardTitleChange}
            ></lightning-input>
        </div>

        <div class="slds-form-element slds-m-bottom_small">
            <lightning-input
                label="Record Type ID (Optional)"
                value={selectedRecordTypeId}
                onchange={handleRecordTypeIdChange}
                placeholder="Leave blank for default record type"
            ></lightning-input>
        </div>

        <div class="slds-form-element slds-m-bottom_small">
            <lightning-input
                type="checkbox"
                label="Is Required"
                checked={isRequired}
                onchange={handleIsRequiredChange}
            ></lightning-input>
        </div>

    </div>
</template>