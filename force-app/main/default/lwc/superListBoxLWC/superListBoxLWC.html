<template>
    <lightning-card>
        <div class="slds-m-around_medium">
            <template if:false={hasCustomDefinitions}>
                <lightning-dual-listbox
                        name="dualListbox"
                        onchange={handleSelectionChange}
                        options={picklistOptions}
                        selected-label="Selected"
                        source-label="Available"
                        value={selectedValues}
                        label={cardTitle}
                ></lightning-dual-listbox>
            </template>
            
            <template if:true={hasCustomDefinitions}>
                <div class="slds-form-element">
                    <label class="slds-form-element__label">{cardTitle}</label>
                    <div class="custom-listbox">
                        <!-- Available Options -->
                        <div class="listbox-container">
                            <div class="listbox-header">Available</div>
                            <div class="options-list">
                                <template for:each={availableOptions} for:item="option">
                                    <div key={option.value} 
                                         class="option-item" 
                                         data-value={option.value}
                                         onclick={handleAvailableClick}>
                                        <span>{option.label}</span>
                                        <template if:true={option.hasHelp}>
                                            <lightning-helptext 
                                                content={option.helpText}
                                                icon-name="utility:info"
                                                class="help-icon">
                                            </lightning-helptext>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </div>
                        
                        <!-- Move Buttons -->
                        <div class="move-buttons">
                            <lightning-button-icon
                                icon-name="utility:chevronright"
                                alternative-text="Move to Selected"
                                variant="border-filled"
                                onclick={moveToSelected}
                                disabled={disableMoveToSelected}>
                            </lightning-button-icon>
                            <lightning-button-icon
                                icon-name="utility:chevronleft"
                                alternative-text="Move to Available"
                                variant="border-filled"
                                onclick={moveToAvailable}
                                disabled={disableMoveToAvailable}>
                            </lightning-button-icon>
                        </div>
                        
                        <!-- Selected Options -->
                        <div class="listbox-container">
                            <div class="listbox-header">Selected</div>
                            <div class="options-list">
                                <template for:each={selectedOptions} for:item="option">
                                    <div key={option.value} 
                                         class="option-item" 
                                         data-value={option.value}
                                         onclick={handleSelectedClick}>
                                        <span>{option.label}</span>
                                        <template if:true={option.hasHelp}>
                                            <lightning-helptext 
                                                content={option.helpText}
                                                icon-name="utility:info"
                                                class="help-icon">
                                            </lightning-helptext>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </lightning-card>
</template>