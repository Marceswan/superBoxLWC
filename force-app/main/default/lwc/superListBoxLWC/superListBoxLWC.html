<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 08-02-2025
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>
    <lightning-card>
        <div class="slds-m-around_medium" key={componentKey}>
            <template if:false={showCustomUI}>
                <lightning-dual-listbox
                        name="dualListbox"
                        onchange={handleSelectionChange}
                        options={picklistOptions}
                        selected-label="Selected"
                        source-label="Available"
                        value={selectedValues}
                        label={cardTitle}
                ></lightning-dual-listbox>
            </template>
            
            <template if:true={showCustomUI}>
                <div class="slds-form-element">
                    <label class="slds-form-element__label">{cardTitle}</label>
                    <div class="custom-listbox">
                        <!-- Available Options -->
                        <div class="listbox-container">
                            <div class="listbox-header">
                                <span>Available</span>
                                <div class="search-container">
                                    <lightning-icon icon-name="utility:search" size="x-small" class="search-icon"></lightning-icon>
                                    <input 
                                        type="text"
                                        placeholder="Search"
                                        value={availableSearchTerm}
                                        onkeyup={handleAvailableSearch}
                                        class="search-field" />
                                </div>
                            </div>
                            <div class="options-list">
                                <template for:each={availableOptions} for:item="option">
                                    <div key={option.value} 
                                         class={option.optionClass}
                                         data-value={option.value}
                                         onclick={handleAvailableClick}>
                                        <div class="option-content">
                                            <template if:true={option.hasIcon}>
                                                <span class="slds-icon_container slds-icon_container_circle" title={option.iconName}>
                                                    <lightning-icon 
                                                        icon-name={option.iconName}
                                                        size="small"
                                                        class="option-icon">
                                                    </lightning-icon>
                                                </span>
                                            </template>
                                            <div class="option-text-wrapper">
                                                <div class="option-main">
                                                    <template if:true={option.showSubtitle}><span class="option-label"><strong>{option.label}</strong></span></template>
                                                    <template if:true={showHelpBubble}><span class="option-label">{option.label}</span></template>
                                                    <template if:true={option.hasHelp}>
                                                        <template if:true={showHelpBubble}>
                                                            <lightning-helptext 
                                                                content={option.helpText}
                                                                icon-name="utility:info"
                                                                class="help-icon">
                                                            </lightning-helptext>
                                                        </template>
                                                    </template>
                                                </div>
                                                <template if:true={option.showSubtitle}>
                                                    <span class="option-subtitle">{option.helpText}</span>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                        
                        <!-- Move Buttons -->
                        <div class="move-buttons">
                            <lightning-button-icon
                                icon-name="utility:chevronright"
                                alternative-text="Move to Selected"
                                variant="border-filled"
                                onclick={moveToSelected}
                                disabled={disableMoveToSelected}>
                            </lightning-button-icon>
                            <lightning-button-icon
                                icon-name="utility:chevronleft"
                                alternative-text="Move to Available"
                                variant="border-filled"
                                onclick={moveToAvailable}
                                disabled={disableMoveToAvailable}>
                            </lightning-button-icon>
                        </div>
                        
                        <!-- Selected Options -->
                        <div class="listbox-container">
                            <div class="listbox-header">
                                <span>Selected</span>
                            </div>
                            <div class="options-list">
                                <template for:each={selectedOptions} for:item="option">
                                    <div key={option.value} 
                                         class={option.optionClass}
                                         data-value={option.value}
                                         onclick={handleSelectedClick}>
                                        <div class="option-content">
                                            <template if:true={option.hasIcon}>
                                                <span class="slds-icon_container slds-icon_container_circle" title={option.iconName}>
                                                    <lightning-icon 
                                                        icon-name={option.iconName}
                                                        size="small"
                                                        class="option-icon">
                                                    </lightning-icon>
                                                </span>
                                            </template>
                                            <div class="option-text-wrapper">
                                                <div class="option-main">
                                                    <template if:true={option.showSubtitle}><span class="option-label"><strong>{option.label}</strong></span></template>
                                                    <template if:true={showHelpBubble}><span class="option-label">{option.label}</span></template>
                                                    <template if:true={option.hasHelp}>
                                                        <template if:true={showHelpBubble}>
                                                            <lightning-helptext 
                                                                content={option.helpText}
                                                                icon-name="utility:info"
                                                                class="help-icon">
                                                            </lightning-helptext>
                                                        </template>
                                                    </template>
                                                </div>
                                                <template if:true={option.showSubtitle}>
                                                    <span class="option-subtitle">{option.helpText}</span>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </lightning-card>
</template>